WITH stg AS (
    SELECT *
    FROM HLT_H_OS_CDA_ENCNTR_STG
    WHERE TO_DATE(EDL_LOAD_DTM) = '2025-12-07'
),
rawz AS (
    SELECT *
    FROM HOSCDA_RAWZ.HLTH_OS_CDA_ENCNTR_RAWZ
    WHERE TO_DATE(EDL_LOAD_DTM) = '2025-12-07'
)

SELECT 
    'EDL_RUN_ID' AS column_name,
    (SELECT COUNT(EDL_RUN_ID) FROM stg)  AS stg_count,
    (SELECT COUNT(EDL_RUN_ID) FROM rawz) AS rawz_count
UNION ALL
SELECT 
    'ENCNTR_ID' AS column_name,
    (SELECT COUNT(ENCNTR_ID) FROM stg),
    (SELECT COUNT(ENCNTR_ID) FROM rawz)
UNION ALL
SELECT 
    'PATIENT_ID',
    (SELECT COUNT(PATIENT_ID) FROM stg),
    (SELECT COUNT(PATIENT_ID) FROM rawz)
UNION ALL
SELECT 
    'EDL_LOAD_DTM',
    (SELECT COUNT(EDL_LOAD_DTM) FROM stg),
    (SELECT COUNT(EDL_LOAD_DTM) FROM rawz);